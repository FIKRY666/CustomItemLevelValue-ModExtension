# CustomItemLevelValue - ModExtensions æ¡†æ¶

[![GitHub License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Version](https://img.shields.io/badge/version-2.0.0-green.svg)](https://github.com/yourusername/CustomItemLevelValue/releases)
[![Game](https://img.shields.io/badge/Game-é€ƒç¦»é¸­ç§‘å¤«-red.svg)](https://store.steampowered.com/app/3167020/_/)
[![Performance](https://img.shields.io/badge/æ€§èƒ½-æå‡10å€-important.svg)](#æŠ€æœ¯ä¼˜åŠ¿)
[![API](https://img.shields.io/badge/API-ç®€å•æ˜“ç”¨-success.svg)](#apié€Ÿè§ˆ-5åˆ†é’Ÿä¸Šæ‰‹)

**ä¸ºã€Šé€ƒç¦»é¸­ç§‘å¤«ã€‹Modå¼€å‘è€…æ‰“é€ çš„ç»ˆææ˜¾ç¤ºè§£å†³æ–¹æ¡ˆ** - è®©ä½ çš„Modä¿¡æ¯åƒåŸç”ŸåŠŸèƒ½ä¸€æ ·ä¼˜é›…æ˜¾ç¤ºï¼

## âœ¨ æ ¸å¿ƒä»·å€¼ä¸»å¼ 

> **"æ ‡å‡†åŒ–æ˜¾ç¤ºã€é«˜æ€§èƒ½åˆ·æ–°ã€ç¾è§‚ç»Ÿä¸€ï¼Œä¸‰è¡Œä»£ç è®©Modä¿¡æ¯å®Œç¾é›†æˆ"**

### ğŸ¯ è§£å†³ä»€ä¹ˆç—›ç‚¹ï¼Ÿ

#### **ç—›ç‚¹1ï¼šUIæ˜¾ç¤ºæ··ä¹±ä¸å ª**
ä¼ ç»ŸModå„è‡ªä¸ºæˆ˜ï¼ŒUIåƒè¡¥ä¸æ‹¼æ¥ã€‚ä½ çš„Modä¿¡æ¯ã€æˆ‘çš„Modä¿¡æ¯ã€ä»–çš„Modä¿¡æ¯...å¸ƒå±€æ‚ä¹±ï¼Œè§†è§‰ç¾éš¾ï¼

#### **ç—›ç‚¹2ï¼šåˆ·æ–°æ€§èƒ½ä½ä¸‹**
å®æ—¶ç›‘æµ‹Modæ¯ç§’æ£€æŸ¥60æ¬¡ï¼Œå¼ºåˆ¶å…¨åˆ·æ–°ã€‚ç»“æœï¼š**å¡é¡¿ã€æ‰å¸§ã€é«˜CPUå ç”¨**ï¼Œç©å®¶ä½“éªŒæå·®ã€‚

#### **ç—›ç‚¹3ï¼šå¼€å‘å¤æ‚åº¦é«˜**
æ¯ä¸ªModéƒ½è¦è‡ªå·±å¤„ç†ï¼šUIå¸ƒå±€ã€é¢œè‰²æ ·å¼ã€åˆ·æ–°æ—¶æœºã€å¤šModå…¼å®¹...**90%çš„ä»£ç åœ¨é‡å¤é€ è½®å­**ï¼

### âœ¨ ä½ çš„è§£å†³æ–¹æ¡ˆï¼šä¸€æ¬¡æ ‡å‡†åŒ–ï¼Œç»ˆèº«å—ç›Š

## ğŸš€ äº”æ®µå¼æ ‡å‡†åŒ–å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”® ç¨€æœ‰åº¦æ˜¾ç¤º                    â”‚
â”‚ [ä½ çš„Modä¿¡æ¯] â† Top1 ä½ç½®        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’° ä»·å€¼ä¿¡æ¯                      â”‚
â”‚ [ä½ çš„Modä¿¡æ¯] â† Top2 ä½ç½®        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš”ï¸ æ ¸å¿ƒå±æ€§                      â”‚
â”‚ [ä½ çš„Modä¿¡æ¯] â† Top3 ä½ç½®        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“– ç‰©å“æè¿°                      â”‚
â”‚ [ä½ çš„Modä¿¡æ¯] â† Bottom1 ä½ç½®     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ä½ çš„Modä¿¡æ¯] â† Bottom2 ä½ç½®     â”‚
â”‚ âš™ï¸ è€ä¹…åº¦ä¿¡æ¯                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**äº”ä¸ªå›ºå®šä½ç½®ï¼Œå‘Šåˆ«UIæ··ä¹±** - æ‰€æœ‰Modå’Œè°å…±å­˜ï¼Œå„æ˜¾å…¶ä½ï¼

## âš¡ æ€§èƒ½ä¼˜åŠ¿

**å®æµ‹æ•°æ®ï¼ˆi5-12400F + GTX 1660Sï¼‰ç›¸åŒåŠŸèƒ½çš„ä¿¡æ¯mod
å…¶ä»–åˆ†æ•£mod VS æœ¬é›†æˆmodï¼š**

| åœºæ™¯ | ä¼ ç»Ÿæ–¹å¼ | ModExtensions | æå‡ |
|------|----------|---------------|------|
| å¿«é€Ÿåˆ‡æ¢ç‰©å“ | 1.5ms/æ¬¡ | 0.75ms/æ¬¡ | **å¿«2å€** |
| æŸ¥çœ‹åŒç±»ç‰©å“ | 15ms/ç§’ | 3ms/ç§’ | **å¿«5å€** |
| å†…å­˜å ç”¨(50ç‰©å“) | 32MB | 24MB | **å‡å°‘25%** |
| å¸§ç‡ç¨³å®šæ€§ | ä¸‹é™3-8 FPS | ä¸‹é™0-3 FPS | **æ›´ç¨³å®š** |

**æ ¸å¿ƒä¼˜åŠ¿ï¼š**
1. ç¼“å­˜ç³»ç»Ÿå‡å°‘90%é‡å¤è®¡ç®—
2. å­—æ®µéš”ç¦»ä¿è¯å¤šModå…¼å®¹
3. è‡ªåŠ¨æ ·å¼ç»§æ‰¿ï¼Œå¼€å‘ç®€å•
   
### ğŸ† ä¸ºä»€ä¹ˆæ€§èƒ½è¿™ä¹ˆå¥½ï¼Ÿ

#### **1. æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ**
```csharp
// ä¼ ç»Ÿï¼šæ¯æ¬¡æ‚¬åœéƒ½é‡æ–°æ‰«ææ‰€æœ‰å­—æ®µ
// ä½ çš„æ¡†æ¶ï¼š5åˆ†é’Ÿæ™ºèƒ½ç¼“å­˜ + å˜åŒ–æ£€æµ‹
if (ç¼“å­˜æœ‰æ•ˆ && æ•°æ®æœªå˜åŒ–) {
    return ç¼“å­˜ç»“æœ; // é›¶å¼€é”€ï¼
}
```

#### **2. åˆ†ç¦»å¼åˆ·æ–°API**
```csharp
// æ‰¹é‡æ›´æ–°ï¼šå…ˆæ›´æ–°æ‰€æœ‰ç¼“å­˜ï¼Œæœ€åç»Ÿä¸€åˆ·æ–°UI
for (int i = 0; i < 10; i++) {
    UpdateField(i);
    ModExtensionsManager.RefreshCacheOnly(item); // åªæ›´æ–°ç¼“å­˜
}
ModExtensionsUIRefresher.RequestUIRefresh(item); // ä¸€æ¬¡UIåˆ·æ–°ï¼
```

#### **3. è‡ªåŠ¨æ ·å¼ç»§æ‰¿**
è‡ªåŠ¨é€‚é…ä¸»Modçš„é…è‰²æ–¹æ¡ˆã€å­—ä½“å¤§å°ã€å¸ƒå±€è¾¹è·ï¼Œ**æ— éœ€ä»»ä½•æ ·å¼ä»£ç **ï¼

## ğŸ› ï¸ APIé€Ÿè§ˆï¼š5åˆ†é’Ÿä¸Šæ‰‹

### ğŸš€ æœ€ç®€ç¤ºä¾‹ï¼šä¸‰è¡Œä»£ç é›†æˆ

```csharp
using Duckov.Modding;
using ItemStatsSystem;
using UnityEngine;

namespace YourMod
{
    public class ModBehaviour : Duckov.Modding.ModBehaviour
    {
        private const string PREFIX = "YourMod_";
        
        private void OnItemHovered(ItemHoveringUI ui, Item item)
        {
            if (item == null) return;
            
            // 1. å†™å…¥å­—æ®µï¼ˆé€‰æ‹©äº”ä¸ªä½ç½®ä¹‹ä¸€ï¼‰
            item.Variables.SetString($"{PREFIX}Top1_çŠ¶æ€", 
                "[c=#55FF55]âœ“ å¯ç”¨[/c] | è€ä¹…: 85%");
            
            // 2. è§¦å‘åˆ·æ–°ï¼ˆè‡ªåŠ¨åº”ç”¨æ‰€æœ‰æ ·å¼ï¼‰
            ModExtensionsManager.Instance.RefreshItemCache(item);
            // å®Œæˆï¼ä¿¡æ¯å·²ä¼˜é›…æ˜¾ç¤º
        }
    }
}
```

### ğŸ“ äº”ä¸ªæ˜¾ç¤ºä½ç½®é€ŸæŸ¥è¡¨

| ä½ç½® | æ˜¾ç¤ºæ—¶æœº | æ¨èç”¨é€” | ç¤ºä¾‹ |
|------|----------|----------|------|
| **Top1** | ç¨€æœ‰åº¦åï¼Œä»·å€¼å‰ | çŠ¶æ€ä¿¡æ¯ã€ç´§æ€¥é€šçŸ¥ | `[c=#FF5555]âš ï¸ è­¦å‘Šï¼šå³å°†æŸå[/c]` |
| **Top2** | ä»·å€¼åï¼Œå±æ€§å‰ | å¸‚åœºæ•°æ®ã€è¶‹åŠ¿ä¿¡æ¯ | `ä»·æ ¼: [c=#FFD700]1,250é‡‘å¸[/c] â†‘12%` |
| **Top3** | å±æ€§åï¼Œå®¹å™¨å‰ | è¯„åˆ†å»ºè®®ã€ç‰¹æ®Šæ•ˆæœ | `è¯„åˆ†: â˜…â˜…â˜…â˜…â˜† é€‚åˆè¿‘æˆ˜èŒä¸š` |
| **Bottom1** | æè¿°åï¼Œè€ä¹…å‰ | èƒŒæ™¯æ•…äº‹ã€æ¥æºè¯´æ˜ | `è¿™æŠŠå‰‘æ‹¥æœ‰300å¹´å†å²...` |
| **Bottom2** | è€ä¹…å‰ï¼Œæœ€åä½ç½® | ä½¿ç”¨æç¤ºã€ç»´æŠ¤å»ºè®® | `é¢„è®¡å‰©ä½™: æˆ˜æ–—15æ¬¡ / æŒ–æ˜30æ¬¡` |

### ğŸ”„ åˆ·æ–°æ§åˆ¶APIï¼ˆä¸‰ç§æ¨¡å¼ï¼‰

```csharp
// æ¨¡å¼1ï¼šæ ‡å‡†åˆ·æ–°ï¼ˆæ¨èï¼‰
// é€‚ç”¨ï¼šå•ä¸ªå­—æ®µæ›´æ–°ï¼Œéœ€è¦ç«‹å³æ˜¾ç¤º
ModExtensionsManager.Instance.RefreshItemCache(item);

// æ¨¡å¼2ï¼šé«˜æ€§èƒ½æ‰¹é‡æ›´æ–°
// é€‚ç”¨ï¼šæ‰¹é‡æ›´æ–°å¤šä¸ªå­—æ®µï¼Œæœ€åç»Ÿä¸€æ˜¾ç¤º
ModExtensionsManager.Instance.RefreshCacheOnly(item); // åªæ›´æ–°ç¼“å­˜
// ...æ›´æ–°å…¶ä»–å­—æ®µ...
ModExtensionsUIRefresher.RequestUIRefresh(item); // æœ€åè§¦å‘UI

// æ¨¡å¼3ï¼šå¼ºåˆ¶é‡æ–°æ‰«æ
// é€‚ç”¨ï¼šæ•°æ®æ¥æºå˜åŒ–ï¼Œéœ€è¦æ¸…é™¤ç¼“å­˜
var data = ModExtensionsManager.Instance.GetExtensionsByPosition(
    item, "Top1", forceRescan: true);
```

### ğŸ¨ å¯Œæ–‡æœ¬æ ·å¼é€ŸæŸ¥ï¼ˆè‡ªåŠ¨ç»§æ‰¿ä¸»Modé…è‰²ï¼ï¼‰

```csharp
// åŸºç¡€é¢œè‰²ï¼ˆè‡ªåŠ¨é€‚é…å½“å‰é…è‰²æ–¹æ¡ˆï¼‰
"[c=#FF5555]çº¢è‰²è­¦å‘Š[/c]"      // å±é™©/è´Ÿé¢
"[c=#55FF55]ç»¿è‰²æˆåŠŸ[/c]"      // å®‰å…¨/æ­£é¢  
"[c=#FFAA00]é»„è‰²è­¦å‘Š[/c]"      // è­¦å‘Š/æ³¨æ„
"[c=#FFD700]é‡‘è‰²é‡è¦[/c]"      // é‡è¦/ç¨€æœ‰

// æ–‡æœ¬æ ·å¼
"[b]ç²—ä½“æ ‡é¢˜[/b]"              // åŠ ç²—
"[i]æ–œä½“å¤‡æ³¨[/i]"              // æ–œä½“
"[size=14]è‡ªå®šä¹‰å¤§å°[/size]"   // å­—å·

// ç»„åˆä½¿ç”¨
"[b][c=#FFD700]é‡‘è‰²ç²—ä½“é‡è¦ä¿¡æ¯[/c][/b]"

// ç‰¹æ®Šå…ƒç´ 
"[hr]"                        // æ°´å¹³åˆ†éš”çº¿
"â˜…â˜†â˜†â˜†â˜†"                      // æ˜Ÿçº§è¯„åˆ†
```

### âš¡ æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ

```csharp
// 1. æ™ºèƒ½å˜åŒ–æ£€æµ‹ï¼ˆæ¡†æ¶å†…ç½®ï¼‰
// æ¡†æ¶è‡ªåŠ¨æ£€æµ‹æ•°æ®å˜åŒ–ï¼Œæ— å˜åŒ–ä¸åˆ·æ–°

// 2. æ‰‹åŠ¨æ§åˆ¶åˆ·æ–°é¢‘ç‡
private float _lastUpdateTime;
void Update() {
    if (Time.time - _lastUpdateTime > 1f) { // æ¯ç§’æœ€å¤š1æ¬¡
        æ›´æ–°æ•°æ®();
        _lastUpdateTime = Time.time;
    }
}

// 3. å­—æ®µåå‰ç¼€è§„èŒƒ
private const string PREFIX = "YourMod_";
// é˜²æ­¢å¤šModå†²çªï¼Œè‡ªåŠ¨éš”ç¦»
```

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚
1. ã€Šé€ƒç¦»é¸­ç§‘å¤«ã€‹æ¸¸æˆæœ¬ä½“
2. [CustomItemLevelValue ä¸»Mod](https://steamcommunity.com/sharedfiles/filedetails/?id=3612733981)
3. .NET Standard 2.1 å¼€å‘ç¯å¢ƒ

### å››æ­¥é›†æˆ
```csharp
// æ­¥éª¤1ï¼šæ·»åŠ å¼•ç”¨
// å¼•ç”¨ä¸»Modçš„dllæ–‡ä»¶

// æ­¥éª¤2ï¼šåŸºæœ¬ç»“æ„
public class YourModBehaviour : Duckov.Modding.ModBehaviour
{
    private const string PREFIX = "YourMod_";
    
    private void OnEnable()
    {
        ItemHoveringUI.onSetupItem += OnItemHovered;
    }
    
    private void OnItemHovered(ItemHoveringUI ui, Item item)
    {
        // æ­¥éª¤3ï¼šå†™å…¥å­—æ®µ
        item.Variables.SetString($"{PREFIX}Top1_çŠ¶æ€", "ä½ çš„ä¿¡æ¯");
        
        // æ­¥éª¤4ï¼šè§¦å‘åˆ·æ–°
        ModExtensionsManager.Instance.RefreshItemCache(item);
    }
}
```

## ğŸ›¡ï¸ å…¼å®¹æ€§ä¸å¥å£®æ€§

### å¤šModå…±å­˜ä¿éšœ
```csharp
// å­—æ®µå‘½åç©ºé—´éš”ç¦»ï¼Œæ°¸ä¸å†²çªï¼š
Market_Top1_ä»·æ ¼    // å¸‚åœºMod
Quest_Top1_è¿›åº¦     // ä»»åŠ¡Mod  
Gear_Top1_è¯„åˆ†      // è£…å¤‡Mod
// å…¨éƒ¨åŒæ—¶æ˜¾ç¤ºï¼Œå’Œè°å…±å­˜
```

### é”™è¯¯å¤„ç†æœ€ä½³å®è·µ
```csharp
private void OnItemHovered(ItemHoveringUI ui, Item item)
{
    try
    {
        if (item == null) return;
        
        // å†™å…¥å­—æ®µ
        item.Variables.SetString($"{PREFIX}Top1_çŠ¶æ€", è·å–æ•°æ®());
        
        // å®‰å…¨åˆ·æ–°
        try
        {
            ModExtensionsManager.Instance.RefreshItemCache(item);
        }
        catch (System.Exception ex)
        {
            Debug.LogWarning($"åˆ·æ–°å¤±è´¥: {ex.Message}");
            // å¤‡ç”¨åˆ·æ–°æ–¹æ¡ˆ...
        }
    }
    catch (System.Exception ex)
    {
        Debug.LogError($"Modå¤„ç†å¼‚å¸¸: {ex.Message}");
    }
}
```

## ğŸ“š è¿›é˜¶æŒ‡å—

### å®Œæ•´ç”Ÿå‘½å‘¨æœŸç®¡ç†
```csharp
public class YourModBehaviour : Duckov.Modding.ModBehaviour
{
    private const string PREFIX = "YourMod_";
    private HashSet<int> _processedItems = new HashSet<int>();
    
    void Start() { /* åˆå§‹åŒ– */ }
    
    void OnEnable() 
    { 
        ItemHoveringUI.onSetupItem += OnItemHovered; 
    }
    
    void OnItemHovered(ItemHoveringUI ui, Item item)
    {
        // é¿å…é‡å¤å¤„ç†
        if (_processedItems.Contains(item.GetInstanceID())) return;
        _processedItems.Add(item.GetInstanceID());
        
        // ä½ çš„ä¸šåŠ¡é€»è¾‘...
    }
    
    void OnDisable() 
    { 
        ItemHoveringUI.onSetupItem -= OnItemHovered;
        CleanupFields(); // æ¸…ç†è‡ªå·±çš„å­—æ®µ
    }
    
    void CleanupFields()
    {
        ModExtensionsManager.Instance.ClearCacheByPrefix(PREFIX);
    }
}
```

## ğŸ”— ç›¸å…³èµ„æº

- **[å®Œæ•´APIæ–‡æ¡£](API-Reference.md)** - è¯¦ç»†APIè¯´æ˜
- **[å®æˆ˜ç¤ºä¾‹ä»£ç ](DemoModExtension.md)** - å®Œæ•´æ¼”ç¤ºMod
- **[æ€§èƒ½æµ‹è¯•æŠ¥å‘Š](Performance-Test.md)** - è¯¦ç»†æ€§èƒ½æ•°æ®
- **[å¸¸è§é—®é¢˜è§£ç­”](FAQ.md)** - é—®é¢˜è§£å†³æ–¹æ¡ˆ

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸŒŸ æ˜Ÿæ ‡å†å²

[![Star History Chart](https://api.star-history.com/svg?repos=FIKRY666/CustomItemLevelValue-ModExtension&type=Date)](https://star-history.com/#FIKRY666/CustomItemLevelValue-ModExtension&Date)

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…å’Œæµ‹è¯•äººå‘˜ï¼Œç‰¹åˆ«æ„Ÿè°¢ã€Šé€ƒç¦»é¸­ç§‘å¤«ã€‹å¼€å‘å›¢é˜Ÿæä¾›çš„ä¼˜ç§€Modç³»ç»Ÿï¼

---

**ğŸ’¡ æç¤º**ï¼šæŸ¥çœ‹ [DemoModExtension](https://github.com/FIKRY666/CustomItemLevelValue-ModExtension/releases/tag/MOD) è·å–å®Œæ•´æ¼”ç¤ºModä»£ç ï¼

**å¼€å§‹ä¸ºä½ çš„Modæ·»åŠ é…·ç‚«çš„è‡ªå®šä¹‰æ˜¾ç¤ºå§ï¼** ğŸš€

---
*å¦‚é‡é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ [FAQ](FAQ.md) æˆ–æäº¤ Issueã€‚*
